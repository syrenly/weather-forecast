import{a as O,b as S}from"./chunk-D2YMVFW4.js";import"./chunk-7GUHW4FQ.js";import{c as D}from"./chunk-JERYN6ER.js";import{a as v,c as w,e as E,g as R}from"./chunk-GYUUGYJE.js";import{j as g}from"./chunk-CCDOUNTY.js";import{Bb as u,Cb as o,Db as c,Eb as C,Sa as m,Xa as n,ac as P,cb as l,ec as I,gb as f,la as h,nc as M,ta as p,wa as d}from"./chunk-7OGJOBW4.js";var $=(()=>{let i=class i extends S{constructor(t,e,a,r){super(e,a,r),this.localeId=t,this.canvasId="precipitationChart",this.rainPrecipitations=[],this.snowPrecipitations=[],this.time=[]}ngOnChanges(t){t.forecastResult&&!t.forecastResult.isFirstChange()&&(this.calculateDataSets(),this.createChart())}ngAfterViewInit(){this.calculateDataSets(),super.ngAfterViewInit()}calculateDataSets(){this.datePipe||this.initializeDatePipe();let t=this.forecastResult?.list||[];this.rainPrecipitations=[],this.snowPrecipitations=[],this.time=[],t.forEach(e=>{let{dt:a}=e;if(!a){console.warn(`Date not found for forecast ${e}`);return}let r=this.datePipe.transform(a*1e3,"MMM, d HH");this.time.push(r);let y=e.rain?.["3h"]||0;this.rainPrecipitations.push(y);let _=e.snow?.["3h"]||0;this.snowPrecipitations.push(_)})}createChart(){let t={labels:this.time,datasets:[{data:this.rainPrecipitations,label:"Rain"},{data:this.snowPrecipitations,label:"Snow"}]};if(this.chart){this.chart.data=t,this.chart.update();return}this.chart=new O(this.canvasId,{type:"line",data:t,options:{}}),this.updateColors()}initializeDatePipe(){this.datePipe=new g(this.localeId)}};i.\u0275fac=function(e){return new(e||i)(n(M),n(D),n(h),n(d))},i.\u0275cmp=l({type:i,selectors:[["app-precipitation-chart"]],inputs:{forecastResult:"forecastResult"},features:[f,p],decls:5,vars:2,consts:[[3,"id"]],template:function(e,a){e&1&&(o(0,"mat-card")(1,"mat-card-header"),P(2,"Precipitation (mm)"),c(),o(3,"mat-card-content"),C(4,"canvas",0),c()()),e&2&&(m(4),u("id",I(a.canvasId)))},dependencies:[R,v,w,E],styles:["[_nghost-%COMP%]   mat-card[_ngcontent-%COMP%]{height:100%}[_nghost-%COMP%]   mat-card-content[_ngcontent-%COMP%]{height:calc(100% - 2rem - 20px)}"]});let s=i;return s})();export{$ as PrecipitationChartComponent};
